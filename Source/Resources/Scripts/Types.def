declare class point
    x : number
end

declare class vec2 extends point
    y : number
end

declare class vec3 extends vec2
    z : number
end

declare class vec4 extends vec3
    w : number
end

declare class Engine
    Name : string
    Version : vector
end
declare Engine : Engine

declare INVALID_UNIT_ID : number

declare class GameEvent
    Invalid                 : number
    Loaded                  : number
    Updated                 : number
    CharacterListChanged    : number
    MapLoading              : number
    ChatMessageReceived     : number
    LocalMoverChanged       : number
    Count                   : number
end
declare GameEvent : GameEvent

declare class UnitEvent
    Invalid             : number
    Add                 : number
    Remove              : number
    TargetChanged       : number
    PowerUpdate         : number
    ResistanceUpdate    : number
    StatUpdate          : number
    AuraAdd             : number
    AuraUpdate          : number
    AuraRemove          : number
    Count               : number
end
declare UnitEvent : UnitEvent

declare class ContainerEvent
    Invalid         : number
    Add             : number
    AddToSlot       : number
    RemoveFromSlot  : number
    SwapSlots       : number
    Count           : number
end
declare ContainerEvent : ContainerEvent

declare class TriggerEvent
    Invalid         : number
    OnEnter         : number
    OnExit          : number
    OnStay          : number
    Count           : number
end
declare TriggerEvent : TriggerEvent

declare class PowerType
    Invalid         : number
    Health          : number
    Mana            : number
    Rage            : number
    Focus           : number
    Energy          : number
    Happiness       : number
    Count           : number
end
declare PowerType : PowerType

declare class StatType
    Invalid         : number
    Health          : number
    Stamina         : number
    Strength        : number
    Agility         : number
    Intellect       : number
    Spirit          : number
    Armor           : number
    AttackPower     : number
    SpellPower      : number
    Count           : number
end
declare StatType : StatType

type Event = GameEvent | UnitEvent | ContainerEvent | TriggerEvent

declare class ContainerItemEventData
    slotIndex   : number
    itemID      : number
    itemCount   : number
end

declare class CharacterInfo
    name    : string
    race    : number
    gender  : number
    class   : number
    level   : number
    mapID   : number
end
declare class CharacterList
    [number] : CharacterInfo
end

declare function RegisterEvent(eventID : Event, callback : ((eventID : Event, data : any) -> any)) : ()
declare function AddCursor(name : string, texture : string) : ()
declare function SetCursor(name : string) : boolean
declare function GetCurrentMap() : string
declare function LoadMap(name : string) : ()
declare function GetMapLoadingProgress() : number
declare function EquipItem(itemID : number, slotIndex : number) : boolean
declare function UnequipItem(slotIndex : number) : boolean
declare function GetEquippedItem(slotIndex : number) : number
declare function ExecCmd(command : string) : boolean
declare function SendChatMessage(message : string) : ()
declare function IsOfflineMode() : boolean
declare function IsOnline() : boolean
declare function GetAuthStage() : number
declare function IsInWorld() : boolean
declare function GetAccountName() : string
declare function Login(accountName : string, password : string, rememberMe : boolean) : boolean
declare function Logout() : boolean
declare function Disconnect() : boolean
declare function GetCharacterList() : CharacterList
declare function SelectCharacter(index : number) : boolean
declare function GetMapName(mapID : number) : string

declare class UIInputEvent
    Invalid        : number
    MouseDown      : number
    MouseUp        : number
    MouseHeld      : number
    MouseScroll    : number

    HoverBegin     : number
    HoverEnd       : number
    HoverHeld      : number

    FocusBegin     : number
    FocusEnd       : number
    FocusHeld      : number
end
declare UIInputEvent : UIInputEvent;

declare class UIKeyboardEvent
    Invalid : number
    Key     : number
    Unicode : number
end
declare UIKeyboardEvent : UIKeyboardEvent;

declare class InputAction
    Invalid : number
    Press   : number
    Release : number
    Click   : number
end
declare InputAction : InputAction;

type MouseEventCallback = ((event : UIInputEvent, widget : Widget, x : number, y : number) -> ())
type KeyboardEventCallback = ((widget : Widget, event : UIKeyboardEvent, ...any) -> ())

declare class WidgetInputEvents
    function SetOnMouseDown(self, callback : MouseEventCallback) : ()
    function SetOnMouseUp(self, callback : MouseEventCallback) : ()
    function SetOnMouseHeld(self, callback : MouseEventCallback) : ()
    function SetOnMouseScroll(self, callback : MouseEventCallback) : ()

    function SetOnHoverBegin(self, callback : MouseEventCallback) : ()
    function SetOnHoverEnd(self, callback : MouseEventCallback) : ()
    function SetOnHoverHeld(self, callback : MouseEventCallback) : ()

    function SetOnFocusBegin(self, callback : MouseEventCallback) : ()
    function SetOnFocusEnd(self, callback : MouseEventCallback) : ()
    function SetOnFocusHeld(self, callback : MouseEventCallback) : ()

    function SetOnKeyboard(self, callback : KeyboardEventCallback) : ()
end

declare class Widget extends WidgetInputEvents
    function NewWidget(self, pos : vec2, layer : number) : Widget
    function NewPanel(self, pos : vec2, size : vec2, layer : number, template : string) : Panel
    function NewText(self, text : string, pos : vec2, layer : number, template : string) : TextWidget

    function SetEnabled(self, enabled : boolean) : ()
    function SetVisible(self, visible : boolean) : ()
    function SetInteractable(self, interactable : boolean) : ()
    function SetFocusable(self, focusable : boolean) : ()

    function GetAnchor(self) : vec2
    function GetRelativePoint(self) : vec2
    function SetAnchor(self, anchor : vec2) : ()
    function SetRelativePoint(self, point : vec2) : ()

    function IsClipChildren(self) : boolean
    function SetClipChildren(self, clipChildren : boolean) : ()
    function GetClipRect(self) : (number, number, number, number)
    function SetClipRect(self, minX : number, minY : number, maxX : number, maxY : number) : ()
    function GetClipMaskTexture(self) : string
    function SetClipMaskTexture(self, texturePath : string) : ()
    
    function GetPos(self) : vec2
    function GetPosX(self) : number
    function GetPosY(self) : number
    function SetPos(self, pos : vec2) : ()
    function SetPosX(self, x : number) : ()
    function SetPosY(self, y : number) : ()
        
    function GetWorldPos(self) : vec2
    function GetWorldPosX(self) : number
    function GetWorldPosY(self) : number
    function SetWorldPos(self, pos : vec2) : ()
    function SetWorldPosX(self, x : number) : ()
    function SetWorldPosY(self, y : number) : ()

    function SetPos3D(self, pos : vec3) : ()
end

declare class Canvas
    function NewWidget(self, pos : vec2, layer : number) : Widget
    function NewPanel(self, pos : vec2, size : vec2, layer : number, template : string) : Panel
    function NewText(self, text : string, pos : vec2, layer : number, template : string) : TextWidget
end

declare class Panel extends Widget
    function GetSize(self) : vec2
    function GetWidth(self) : number
    function GetHeight(self) : number
    function SetSize(self, size : vec2) : ()
    function SetWidth(self, width : number) : ()
    function SetHeight(self, height : number) : ()

    function SetBackground(self, background : string) : ()
    function SetForeground(self, foreground : string) : ()
    
    function SetTexCoords(self, minX : number, minY : number, maxX : number, maxY : number) : ()
    function SetColor(self, color : vec3, alpha : number?) : ()
    function SetAlpha(self, alpha : number) : ()    
end

declare class TextWidget extends Widget
    function GetText(self) : string
    function SetText(self, text : string) : ()
    function GetRawText(self) : string
    function GetSize(self) : vec2
    function GetFontSize(self) : number
    function SetFontSize(self, size : number) : ()
    function GetWidth(self) : number
    function GetHeight(self) : number
    function GetColor(self) : vec3
    function SetColor(self, color : vec3) : ()
    function GetWrapWidth(self) : number
    function GetWrapIndent(self) : number
    function SetWrapIndent(self, size : number) : ()
end

declare class EventTemplate
    onMouseDown : MouseEventCallback?
    onMouseUp : MouseEventCallback?
    onMouseHeld : MouseEventCallback?

    onHoverBegin : MouseEventCallback?
    onHoverEnd : MouseEventCallback?
    onHoverHeld : MouseEventCallback?

    onFocusBegin : MouseEventCallback?
    onFocusEnd : MouseEventCallback?
    onFocusHeld : MouseEventCallback?
end

declare class PanelTemplate extends EventTemplate
    background : string?
    foreground : string?
    color : vector?
    cornerRadius : number?
    texCoords : vec4?
    nineSliceCoords : vec4?
    onClickTemplate : string?
    onHoverTemplate : string?
    onUninteractableTemplate : string?

    EventTemplate : EventTemplate?
end

declare class TextTemplate extends EventTemplate
    font : string?
    size : number?
    color : vector?
    borderSize : number?
    borderColor : vector?

    EventTemplate : EventTemplate?
end

type SendMessageToChatCallback = ((channel : string, playerName : string, text : string, isOutgoing : boolean) -> ())

declare UI :
{
    RegisterPanelTemplate : ((name : string, template : PanelTemplate) -> ()),
    RegisterTextTemplate : ((name : string, template : TextTemplate) -> ()),

    RegisterSendMessageToChatCallback : ((callback : SendMessageToChatCallback) -> ()),

    GetCanvas : ((name : string, pos : vec2, size : vec2, isRenderTexture : boolean?) -> Canvas),
    GetMousePos : (() -> vec2),
    GetTextureSize : ((path : string) -> vec2),

    PixelsToTexCoord : ((pos : vec2, size : vec2) -> vec2),
    CalculateTextSize : ((text : string, template : string) -> vec2),
    WrapText : ((text : string, template : string, wrapWidth : number?) -> (string, vec2)),
    
    FocusWidget : ((widget : Widget) -> ()),
    UnfocusWidget : ((widget : Widget) -> ()),
    IsFocusedWidget : ((widget : Widget) -> boolean),
    WasJustFocusedWidget : ((widget : Widget) -> boolean),
    GetFocusedWidget : (() -> Widget),

    IsHoveredWidget : ((widget : Widget) -> boolean),

    DestroyWidget : ((widget : Widget) -> boolean),

    AddOnKeyboard : ((event : UIKeyboardEvent, ...any) -> boolean),
}

declare Cursor : Canvas

declare class Box
    --min : vec2
    --max : vec2
end

declare Box :
{
    new : ((min : vec2, max : vec2) -> Box)
}

declare Unit :
{
    GetLocal            : (() -> number),
    GetName             : ((unitID : number) -> string),
    GetHealth           : ((unitID : number) -> (number, number)),
    GetResourceType     : ((unitID : number) -> PowerType),
    GetResource         : ((unitID : number, resourceType : number?) -> (number, number)),
    GetStat             : ((unitID : number, statType : number) -> (number, number)),
    GetAuras            : ((unitID : number) -> { [number] : AuraInfo }),

    SetWidgetToNamePos  : ((widget : Widget, unitID : number) -> ()),
}

declare class AuraInfo
    auraID : number
    spellID : number
    duration : number
    stacks : number
end

declare class ItemInfo
    DisplayID : number
    Bind : number
    Rarity : number
    Category : number
    Type : number
    VirtualLevel : number
    RequiredLevel : number
    Durability : number
    IconID : number
    Name : string
    Description : string
    RequiredText : string
    SpecialText : string
    Armor : number
    StatTemplateID : number
    ArmorTemplateID : number
    WeaponTemplateID : number
    ShieldTemplateID : number
end

declare class ItemStatInfo
    [number] : ItemStat
end
declare class ItemStat
    ID : number
    Value : number
end

declare class ItemArmorInfo
    EquipType : number
    BonusArmor : number
end

declare class ItemWeaponInfo
    WeaponStyle : number
    MinDamage : number
    MaxDamage : number
    Speed : number
end

declare class ItemShieldInfo
    BonusArmor : number
    Block : number
end

declare class ItemDisplayInfo
    ItemVisual : number
    ParticleColorID : number
    ItemRangedDisplayInfoID : number
    OverrideSwooshSoundKitID : number
    SheatheTransformMatrixID : number
    StateSpellVisualKitID : number
    SheathedSpellVisualKitID : number
    UnsheathedSpellVisualKitID : number
    Flags : number
    ModelResourcesID1 : number
    ModelResourcesID2 : number
    MaterialResourcesID1 : number
    MaterialResourcesID2 : number
    ModelType1 : number
    ModelType2 : number
    GoesetGroup1 : number
    GoesetGroup2 : number
    GoesetGroup3 : number
    GoesetGroup4 : number
    GoesetGroup5 : number
    GoesetGroup6 : number
    GeosetAttachmentGroup1 : number
    GeosetAttachmentGroup2 : number
    GeosetAttachmentGroup3 : number
    GeosetAttachmentGroup4 : number
    GeosetAttachmentGroup5 : number
    GeosetAttachmentGroup6 : number
    GeosetHelmetVis1 : number
    GeosetHelmetVis2 : number
end

declare class ItemEffectType
    OnEquip     : number
    OnUse       : number
    OnProc      : number
    OnLooted    : number
    OnBound     : number
end
declare ItemEffectType : ItemEffectType;

declare class ItemEffectInfo
    ItemID : number
    Slot : number
    Type : ItemEffectType
    SpellID : number
end

declare class SpellInfo
    Name : string
    Description : string
    AuraDescription : string
    IconID : number
end

declare class Icon
    Texture : number
end
declare Item :
{
    GetItemInfo         : ((itemID : number) -> ItemInfo),
    GetItemStatInfo     : ((itemStatInfoID : number) -> ItemStatInfo),
    GetItemArmorInfo    : ((itemArmorInfoID : number) -> ItemArmorInfo),
    GetItemWeaponInfo   : ((itemWeaponInfoID : number) -> ItemWeaponInfo),
    GetItemShieldInfo   : ((itemShieldInfoID : number) -> ItemShieldInfo),
    GetItemDisplayInfo  : ((itemDisplayID : number) -> ItemDisplayInfo),
    GetItemEffects      : ((itemID : number) -> { ItemEffectInfo } ),
    GetIconInfo         : ((itemIconID : number) -> Icon)
}

declare Spell :
{
    GetSpellInfo    : ((spellID : number) -> SpellInfo),
    GetIconInfo     : ((spellIconID : number) -> Icon)
}

declare Container :
{
    RequestSwapSlots : ((containerIndex : number, srcSlotIndex : number, destSlotIndex : number) -> boolean),
    GetContainerItems : ((containerIndex : number) -> { ContainerItemEventData }),
}

declare class OptionType
    InputBox    : number
    Checkbox    : number
    Slider      : number
    ComboBox    : number
end
declare OptionType : OptionType;

declare class OptionCategoryType
    Gameplay        : string
    Keybindings     : string
    Accessibility   : string
    System          : string
end
declare OptionCategoryType : OptionCategoryType;

declare class NameplateTextDisplayType
    None            : number
    Value           : number
    ValueAndPercent : number
end
declare NameplateTextDisplayType : NameplateTextDisplayType;